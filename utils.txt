utility function fir version 2